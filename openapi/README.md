# Generating TS models for APIs

## OpenAPI specs

We are consuming different APIs, therefore we are generating TS models from different sources.

The OpenAPI specs we use are:

- https://api.stage.openshift.com/api/clusters_mgmt/v1/openapi
- https://api.stage.openshift.com/api/accounts_mgmt/v1/openapi
- https://console.redhat.com/api/cost-management/v1/openapi.json
- https://api.stage.openshift.com/api/access_transparency/v1/openapi
- https://console.redhat.com/api/insights-results-aggregator/v1/openapi.json
- https://console.redhat.com/api/insights-results-aggregator/v2/openapi.json
- https://api.stage.openshift.com/api/service_logs/v1/openapi
- https://api.stage.openshift.com/api/upgrades_info/v1/openapi

## CI

In order to keep the OCMUI model types up to date, a pipeline has been provided. This can be found at `.github/check-api-pipeline.yml`. The pipeline consists of:

- Getting latest Open API contracts from public or private spaces.
- Checking for differences of files generated by the previous command, otherwise the pipeline just exits.
- Generating model types based on the Open API contracts.
- Pushing the changes and creating a pull request.

The pipeline is configured to run daily.

## Generating TS models locally 

Run `make openapi` (at the root level) to fetch new specs and generate types inside `src/types`